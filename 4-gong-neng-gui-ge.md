# 4 功能规格

## 介绍

安全硬件扩展 (SHE) 是对任何给定微控制器的片上扩展。 它旨在将对加密密钥的控制从软件域转移到硬件域，从而保护这些密钥免受软件攻击。 但是，它并不意味着要取代 TPM 芯片或智能卡等高度安全的解决方案，即规范不要求防篡改。

当前设计的主要目标是：

* 保护密钥免受软件攻击
* 提供真实的软件环境
* 让安全只取决于底层算法的强度和密钥的机密性
* 允许分布式密钥所有权
* 保持高灵活性和低成本

基本上，SHE 由三个构建块组成，一个用于保存密钥和其他相应信息的存储区域，一个分组密码 (AES) 的实现以及一个将这些部分连接到微控制器 CPU 的控制逻辑，请参见图 4.1 的简化框图。 SHE 可以通过多种方式实施，例如有限状态机或小型专用 CPU 内核。

<figure><img src=".gitbook/assets/图片.png" alt=""><figcaption><p>图 4.1：SHE 的简化逻辑结构</p></figcaption></figure>

本文档旨在提供 SHE 技术实现的详细描述，并将以参考实现作为补充。 本文档不包含每个单独要求的动机，也不包含如何在某些应用程序中使用 SHE 的概念。

请注意，SHE 不会通过简单地将其添加到微控制器来解决所有安全漏洞。 它必须得到应用软件和流程的支持。

### 约定

在接下来的章节中，有几段以斜体印刷。 这些段落并不是硬性要求，而是提供对基本机制的额外解释。

在整个文档中，术语“CPU”表示实际的微处理器，而“微控制器”用于描述硬件完整芯片，即 CPU 和所有包含的外围设备。 术语“控制逻辑”是指控制 SHE 内部算法和存储器的系统（例如有限状态机或小型微处理器）。

密码操作写为

$$
OUTPUT = OPERATION_{MODE,KEY[,IV]} (INPUT [, INPUT2, ...])
$$

此外，以下符号用于描述操作：

* ⊕ 按位异或
* \| 串联两个值（concatenation of two values）

每当描述到 CPU 的接口时，不暴露给 CPU 的 SHE 的内部存储器槽由它们的地址标识。 实际的密钥一般写为 KEY\_{KEY\_NAME}，而密钥的标识符则写为 ID\_{KEY\_NAME}。

所有值均以 MSB...LSB 的形式给出，即最高有效位/字节位于左侧。

形式给出的位序列

"0...0"128

应表示值为“0”且长度为 128 的位串。
